	{"global":{"id":0,"initial":false,"name":"Always","rules":[{"actions":[{"stateId":8,"type":"ChangeState"}],"condition":"","description":"","id":0,"when":{"eventSource":"Asset_Returned__e","type":"Event"}},{"actions":[{"exitCode":"Success","type":"Terminate"}],"condition":"","description":"","id":1,"when":{"eventSource":"Asset_Case_Closed__e","type":"Event"}}]},"properties":{},"states":[{"id":1,"initial":true,"name":"Default","rules":[{"actions":[{"stateId":2,"type":"ChangeState"}],"condition":"","description":"When the activation message event occurs, send the Asset to Watching Activation state.","id":0,"when":{"eventSource":"BEACON_Activation_Message__e","type":"Event"}},{"actions":[{"stateId":3,"type":"ChangeState"}],"condition":"","description":"When the standard message event occurs first (before the Activation message), send the Asset to Missed Activation state.","id":1,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}}]},{"id":2,"initial":false,"name":"Watching Activation","rules":[{"actions":[{"stateId":4,"type":"ChangeState"}],"condition":"","description":"The Asset was successfully activated and we are going to keep it in this state for two days.  Send to Normal Communication state if signal strength is good.","id":0,"when":{"type":"Day","value":"2"}},{"actions":[{"stateId":7,"type":"ChangeState"}],"condition":"","description":"The Asset was successfully activated and we are going to keep it in this state for two days.  Send to Installation Communication Error state if signal strength is bad or if the endpoint stops communicating.","id":3,"when":{"type":"Day","value":"2"}}]},{"id":3,"initial":false,"name":"Missed Activation","rules":[{"actions":[{"stateId":2,"type":"ChangeState"}],"condition":"","description":"The Asset did not send the Activation message.  Try to get the message resent.","id":0,"when":{"eventSource":"BEACON_Activation_Message__e","type":"Event"}}]},{"id":4,"initial":false,"name":"Normal Communication","rules":[{"actions":[{"stateId":4,"type":"ChangeState"}],"condition":"","description":"Asset is communicating normally.","id":3,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}},{"actions":[{"stateId":5,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Marginal Communication state if the signal strength is poor.","id":0,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}},{"actions":[{"stateId":6,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Lost Communication state if no messages have been heard.","id":1,"when":{"type":"Day","value":"2"}}]},{"id":5,"initial":false,"name":"Marginal Communication","rules":[{"actions":[{"stateId":4,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Normal Communication state if the signal strength improves.","id":0,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}},{"actions":[{"stateId":5,"type":"ChangeState"}],"condition":"","description":"The Asset continues to communicate poorly.","id":3,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}},{"actions":[{"stateId":6,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Lost Communication state if no messages have been heard.","id":1,"when":{"type":"Day","value":"2"}}]},{"id":6,"initial":false,"name":"Lost Communication","rules":[{"actions":[{"stateId":4,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Normal Communication state if the signal strength improves.","id":0,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}},{"actions":[{"stateId":5,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Marginal Communication state if the signal strength is poor.","id":1,"when":{"eventSource":"BEACON_Standard_Message__e","type":"Event"}}]},{"id":7,"initial":false,"name":"Installation Communication Error","rules":[{"actions":[{"stateId":8,"type":"ChangeState"}],"condition":"","description":"Send the Asset to Returned state when the Returned event occurs.","id":0,"when":{"eventSource":"Asset_Returned__e","type":"Event"}}]},{"id":8,"initial":false,"name":"Returned","rules":[{"actions":[{"exitCode":"Success","type":"Terminate"}],"condition":"","description":"Exit the Asset when the Case is closed.","id":0,"when":{"eventSource":"Asset_Case_Closed__e","type":"Event"}}]}],"variables":[{"condition":"","dataType":"Number","description":"Store activated signal strength while in Watching Activation state","eventSource":"BEACON_Activation_Message__e","id":0,"initialValue":"0","name":"Activation_Communication_Strength","value":{"formula":"Activation_Communication_Strength","type":"Custom"}},{"condition":"","dataType":"Number","description":"Display what the most recent signal strength was.","eventSource":"BEACON_Standard_Message__e","id":1,"initialValue":"0","name":"Standard_Communication_Strength","value":{"formula":"Standard_Communication_Strength","type":"Custom"}},{"condition":"ISBLANK(Asset.InstallDate)","dataType":"Number","description":"If in Missed Activation state, we need to retry sending the Activation Message.  If Missed Activation Count is greater than three.  Create a Case.","eventSource":"BEACON_Standard_Message__e","id":2,"initialValue":"0","name":"Missed_Activation_Count","value":{"formula":"Missed_Activation_Count + 1","type":"Custom"}},{"condition":"Asset.Default_Communication_Strength_Threshold__c < BEACON_Standard_Message__e.Signal_Strength__c","dataType":"Number","description":"Total good standard message communications.","eventSource":"BEACON_Standard_Message__e","id":3,"initialValue":"0","name":"Good_Communications","value":{"formula":"Good_Communications + 1","type":"Custom"}},{"condition":"Asset.Default_Communication_Strength_Threshold__c > BEACON_Standard_Message__e.Signal_Strength__c","dataType":"Number","description":"Total bad standard message communications.","eventSource":"BEACON_Standard_Message__e","id":4,"initialValue":"0","name":"Bad_Communications","value":{"formula":"Bad_Communications + 1","type":"Custom"}},{"dataType":"DateTime","description":"Date and Time the Activation message was received.","eventSource":"BEACON_Activation_Message__e","id":5,"initialValue":"NOW()","name":"Activation_Date","value":{"formula":"BEACON_Activation_Message__e.CreatedDate","type":"Custom"}},{"condition":"","dataType":"DateTime","description":"Date and Time of the last message received.","eventSource":"BEACON_Standard_Message__e","id":6,"initialValue":"NOW()","name":"Last_Communication_Date","value":{"formula":"BEACON_Standard_Message__e.CreatedDate","type":"Custom"}}]}